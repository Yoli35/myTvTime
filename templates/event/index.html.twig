{% extends 'base.html.twig' %}

{% block title %}myTvTime ▶ ︎{{ 'My events'|trans }}{% endblock %}
{% block description %}{{ 'List of all my events'|trans }}{% endblock %}
{% block keywords %}{{ 'event'|trans }}{% endblock %}
{% block body %}
    {{ include('blocks/_mainMenu.html.twig') }}
    <div class="container">
        <div class="my-events">
            <div class="header">
                <h1>{{ 'My Events'|trans }}</h1>
                <div class="backdrop"></div>
            </div>

            {{ include('blocks/_nav.html.twig', {thisPage:('My events'|trans)}) }}

            <main>
                <div class="events">
                    <div class="add-event"><i class="fa-solid fa-circle-plus"></i> {{ 'Add event'|trans }}</div>
                    {% for event in events %}
                        <a href="{{ path('app_event_show', {id: event.id}) }}">
                            <div class="event" data-id="{{ event.id }}">
                                <div class="poster">
                                    <img src="/images/events/thumbnails/{{ event.thumbnail }}" alt="{{ event.name }}">
                                </div>
                                <div class="infos">
                                    <h2>{{ event.name }}</h2>
                                    <div>{{ event.subheading }}</div>
                                    <div id="{{ event.id }}" class="tools">
                                        <i class="fa-solid fa-pen-to-square" title="{{ 'Edit'|trans }}"></i>
                                        {#                                                <i class="fa-solid fa-eye-slash" title="{{ 'Hide'|trans }}"></i> #}
                                        <i class="fa-solid fa-trash-can" title="{{ 'Delete'|trans }}"></i>
                                    </div>
                                </div>
                                <div class="countdown" id="{{ event.id }}">
                                    {{ event.date|format_date('full') }}<br/>
                                    {{ event.date|format_time('medium') }}
                                </div>
                            </div>
                        </a>
                    {% else %}
                        <div class="no-event">{{ 'No event'|trans }}</div>
                    {% endfor %}
                </div>
            </main>
        </div>

        {{ include('blocks/_pageFooter.html.twig') }}

    </div>
    <dialog class="confirm-deletion">
        <div class="overlay">
            <div class="header">
                {{ 'Delete this event?'|trans }}
                <div class="close"><i class="fa-solid fa-xmark"></i></div>
            </div>
            <div class="content">
                {{ 'Do you really want to delete this event?'|trans }}
                <span></span>
                {{ 'This operation is final and cannot be cancelled.'|trans }}
            </div>
            <div class="footer">
                <button value="nope" class="btn btn-secondary delete-cancel">{{ 'Cancel'|trans }}</button>
                <button value="yass" class="btn btn-danger delete-done">{{ 'Delete'|trans }}</button>
            </div>
        </div>
    </dialog>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="/js/event.js" type="module"></script>
    <script>
        initEvents(setCountdownValues(), "{{ app.request.locale }}");

        function setCountdownValues() {
            countdownValues = [];
            {% for e in events %}

            countdownValues[{{ loop.index0 }}] = {"id": {{ e.id }}, "interval": -1, "date": "{{ e.date|format_datetime('short','short', locale='en-US') }}"};
            {% endfor %}

            return countdownValues;
        }
    </script>
{% endblock %}
