{% extends 'base.html.twig' %}

{% block title %}my TvTime ▶ ︎{{ 'My events'|trans }} ▶ ︎{{ event.name }}{% endblock %}

{% block body %}
    {{ include('blocks/_mainMenu.html.twig') }}
    <div class="container">
        <div class="my-event">
            <div class="header">
                <h1>{{ 'My Events'|trans }}</h1>
                <div class="backdrop"></div>
            </div>

            {{ include('blocks/_nav.html.twig', {thisPage: event.name, user: app.user, parent: {url: path('app_event'), page: 'My Events'}}) }}

            <main>
                <div class="sub-header">
                    <div class="thumbnail">
                        <img src="/images/events/thumbnails/{{ event.thumbnail }}" alt="{{ event.name }}">
                    </div>
                    <div class="banner">
                        <img src="/images/events/banners/{{ event.banner }}" alt="{{ event.name }}">
                    </div>
                </div>
                <h2>{{ event.name }}</h2>
                <h3>{{ event.subheading }}</h3>

                <div class="dates">
                    <div class="date">{{ 'Created At'|trans }} : {{ event.createdAt|format_datetime() }}</div>
                    <div class="date">{{ 'Updated At'|trans }} : {{ event.updatedAt|format_datetime() }}</div>
                </div>

                <div class="countdown" id="{{ event.id }}">
                    {{ event.date|format_date('full') }}<br/>
                    {{ event.date|format_time('medium') }}
                </div>

                <div class="description">{{ event.description|raw }}</div>

                <div class="images">
                    {% for image in event.images %}
                        <div class="image">
                            <figure>
                                <img src="/images/events/images/{{ image.path }}" alt="{{ image.caption }}">
                                <figcaption>{{ image.caption }}</figcaption>
                            </figure>
                        </div>
                    {% endfor %}
                </div>
            </main>
        </div>
        {{ include('blocks/_pageFooter.html.twig') }}
    </div>
{% endblock %}
{% block javascripts %}
    {{ parent() }}
    <script src="/js/event.js"></script>
    <script src="/js/diaporama.js"></script>
    <script>
        window.addEventListener("DOMContentLoaded", () => {

            initHeader();
            initCountdowns(setCountdownValues());
            document.querySelector(".header").setAttribute("style", "background: transparent;");

            const images = document.querySelector(".my-event").querySelector(".images").querySelectorAll("img");
            initDiaporama(images, "{{ app.request.locale }}");
        })

        function setCountdownValues() {
            countdownValues = [];
            countdownValues[0] = {"id": {{ event.id }}, "date": "{{ event.date|format_datetime('short','short', locale='en-US') }}"};
            return countdownValues;
        }
    </script>
{% endblock %}
